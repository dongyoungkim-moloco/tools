package main

import (
	"strings"
	"testing"
)

const input1 = `
[
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"b30a5b63-2240-4ccc-a4a6-bb76303fc67d\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":360,\"h\":677},{\"w\":320,\"h\":480}],\"w\":360,\"h\":677,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":360,\"h\":677,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":360,\"h\":677,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.9.0\",\"instl\":1,\"tagid\":\"msa_rv_bidding\",\"bidfloor\":1.8239090909090907,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"b9a0eeaaf639734ac37f3acf2a6d4041ea8419c27f90dc365d9f0e6eeabb2b34dafc933db0639769a3279d4f27ad5570\",\"name\":\"My Story: Choose Your Own Path\",\"bundle\":\"org.nanobit.mystory\",\"storeurl\":\"https://play.google.com/store/apps/details?id=org.nanobit.mystory\",\"cat\":[\"IAB9-30\"],\"ver\":\"6.8\",\"publisher\":{\"id\":\"214e146466d642cca931ce8c733eda66\"},\"ext\":{\"appstoreid\":\"org.nanobit.mystory\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 10; EML-L09 Build/HUAWEIEML-L09; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.73 Mobile Safari/537.36\",\"geo\":{\"lat\":53.5652,\"lon\":-2.3765,\"type\":2,\"ipservice\":3,\"country\":\"GBR\",\"region\":\"ENG\",\"city\":\"Bolton\",\"utcoffset\":60},\"dnt\":0,\"lmt\":0,\"ip\":\"82.21.252.234\",\"devicetype\":4,\"make\":\"HUAWEI\",\"model\":\"EML-L09\",\"os\":\"android\",\"osv\":\"10\",\"hwv\":\"EML-L09\",\"h\":2031,\"w\":1080,\"ppi\":480,\"pxratio\":3,\"js\":1,\"language\":\"en_GB\",\"connectiontype\":2,\"ifa\":\"8e89fa21-d861-4515-a124-8071325103de\",\"ext\":{\"audiovolume\":0.47}},\"user\":{\"ext\":{\"consent\":\"1\"}},\"at\":1,\"tmax\":2740,\"bcat\":[\"IAB14-1\",\"IAB11\",\"IAB9-7\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"funplus.net\",\"funplus.com\",\"nanobit.co\",\"ashleymadison.com\"],\"bapp\":[\"com.pixelberrystudios.choices\",\"com.episodeinteractive.android.catalog\",\"com.mars.avgchapters\",\"com.crowdstar.covetfashion\",\"es.parrotgames.restaurantcity\"],\"source\":{\"fd\":1,\"tid\":\"c3139086-9b32-4b4a-a28c-71adc999b8ad\",\"pchain\":\"29e595b1aeb5904d:214e146466d642cca931ce8c733eda66\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"214e146466d642cca931ce8c733eda66\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":1}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"f2bc0007-542e-4d50-a857-7a0e55c10329\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":703,\"h\":360},{\"w\":480,\"h\":320}],\"w\":703,\"h\":360,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":703,\"h\":360,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":703,\"h\":360,\"id\":\"1\",\"ext\":{\"rp\":{\"size_id\":15,\"alt_size_ids\":[101,67,53]}}}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"bidfloor\":0.5854155844155844,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"9d8c383c3f1f0e7095bf79a448d09682eecd3e04e1764daec3e229fc7887d731421faec7f65c5d595953a5ac2254ee01\",\"name\":\"My Cafe â€” Restaurant game\",\"bundle\":\"com.melesta.coffeeshop\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.melesta.coffeeshop\",\"ver\":\"2022.3.1.0\",\"publisher\":{\"id\":\"4808707580f840288b44779cfc32894f\"},\"ext\":{\"appstoreid\":\"com.melesta.coffeeshop\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; SM-A405FN Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.58 Mobile Safari/537.36\",\"geo\":{\"lat\":49.1995,\"lon\":16.6296,\"type\":2,\"ipservice\":3,\"country\":\"CZE\",\"region\":\"64\",\"city\":\"Brno\",\"utcoffset\":120},\"dnt\":0,\"lmt\":0,\"ip\":\"194.212.102.203\",\"devicetype\":5,\"make\":\"samsung\",\"model\":\"SM-A405FN\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"SM-A405FN\",\"h\":810,\"w\":1583,\"ppi\":160,\"pxratio\":2.25,\"js\":1,\"language\":\"cs\",\"connectiontype\":2,\"ifa\":\"3f895c70-cb90-40e1-b1e3-bf4f58d63ccb\",\"ext\":{\"audiovolume\":0}},\"user\":{},\"at\":1,\"tmax\":797,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"glu.com\",\"casualjoygames.com\",\"dragonplus.com\",\"mytona.com\",\"smartfunapps.com\",\"ogzhimyr.com\",\"playrix.com\",\"ashleymadison.com\"],\"bapp\":[\"com.mytona.cookingdiary\",\"com.smartfunapps.crazydiner\",\"com.cookingcity.chef.kitchen.craze.fever.com.casualjoygames.cooking.kitchen\",\"com.dragonplus.cookingfrenzy\",\"com.techvision.restaurant\",\"com.glu.dashtown\",\"com.goodville.goodgame\"],\"source\":{\"fd\":1,\"tid\":\"f44a1965-19c6-479e-9d95-a8e98c13a561\",\"pchain\":\"29e595b1aeb5904d:4808707580f840288b44779cfc32894f\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"c329d1143bf3b9563361b924b1606c36f232d2ac089a3fbaa4e8224c5c68c56b0a2d3562e0f7ebc5cdc7e601f9883aef\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"4808707580f840288b44779cfc32894f\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"8b4059b3-5f0b-4160-a0ea-4280c137a4f4\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":392,\"h\":767},{\"w\":320,\"h\":480}],\"w\":392,\"h\":767,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"interstitial\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":392,\"h\":767,\"placement\":5,\"skip\":1,\"skipafter\":5,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":392,\"h\":767,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"interstitial\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.9.0\",\"instl\":1,\"tagid\":\"MAX_CC_AND_IV_Tapjoy_Bidding\",\"bidfloor\":0.7158634085726363,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"959d02136cf59886ceff194ee5596805f25041b9c45b36b2c7799194b024129c453bcba24c835658ab5876a29c000246\",\"name\":\"ClipClaps - Find your interest\",\"bundle\":\"com.sanhe.clipclaps\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.sanhe.clipclaps\",\"cat\":[\"IAB14\"],\"ver\":\"3.8.7\",\"publisher\":{\"id\":\"de68ccb6b09443d19097082da78b3bf0\"},\"ext\":{\"appstoreid\":\"com.sanhe.clipclaps\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; M2003J15SC Build/RP1A.200720.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.73 Mobile Safari/537.36\",\"geo\":{\"lat\":4.571,\"lon\":-72.9623,\"type\":2,\"ipservice\":3,\"country\":\"COL\",\"region\":\"MET\",\"city\":\"Barranca de Upia\",\"utcoffset\":-300},\"dnt\":0,\"lmt\":0,\"ip\":\"170.246.113.75\",\"devicetype\":4,\"make\":\"Xiaomi\",\"model\":\"M2003J15SC\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"M2003J15SC\",\"h\":2110,\"w\":1080,\"ppi\":440,\"pxratio\":2.75,\"js\":1,\"language\":\"es_US\",\"connectiontype\":2,\"ifa\":\"dba7438f-703f-4ed6-8b08-641208dff887\",\"ext\":{\"audiovolume\":0.27}},\"user\":{},\"at\":1,\"tmax\":2786,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"ashleymadison.com\"],\"source\":{\"fd\":1,\"tid\":\"3b789777-2bee-4269-beb3-d8991167d631\",\"pchain\":\"29e595b1aeb5904d:de68ccb6b09443d19097082da78b3bf0\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"de68ccb6b09443d19097082da78b3bf0\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":0}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"8c2f630e-480e-4a89-84db-2584411e5b23\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":420,\"h\":908},{\"w\":320,\"h\":480}],\"w\":420,\"h\":908,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"interstitial\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":420,\"h\":908,\"placement\":5,\"skip\":1,\"skipafter\":5,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":420,\"h\":908,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"interstitial\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"tagid\":\"IV_MAX\",\"bidfloor\":8.631557027439728,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{\"skadn\":{\"version\":\"2.0\",\"versions\":[\"2.0\"],\"sourceapp\":\"591560124\",\"skadnetids\":[\"9t245vhmpl.skadnetwork\"]}}}],\"app\":{\"id\":\"647384f929f1253da441b5eeca52ca2e28a217f0ffbc0d6966ceea82c1dc9dc0f84f436ad258f6a825b6ab8fc6133139\",\"name\":\"Musi - Simple Music Streaming\",\"bundle\":\"591560124\",\"storeurl\":\"https://apps.apple.com/app/id591560124\",\"cat\":[\"IAB1-6\"],\"ver\":\"26175\",\"publisher\":{\"id\":\"fd1d59cfe7a8484885922c498a244583\"},\"ext\":{\"appstoreid\":\"591560124\"}},\"device\":{\"ua\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 15_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148\",\"geo\":{\"lat\":30.25,\"lon\":-90.91,\"type\":2,\"ipservice\":3,\"country\":\"USA\",\"region\":\"LA\",\"city\":\"Gonzales\",\"utcoffset\":-300},\"dnt\":0,\"lmt\":1,\"ip\":\"68.227.137.0\",\"devicetype\":4,\"make\":\"Apple\",\"model\":\"iPhone14,3\",\"os\":\"ios\",\"osv\":\"15.4\",\"hwv\":\"iPhone14,3\",\"h\":2778,\"w\":1284,\"ppi\":160,\"pxratio\":3.05625,\"js\":1,\"language\":\"en_US\",\"connectiontype\":2,\"ext\":{\"atts\":1,\"audiovolume\":0,\"ifv\":\"D2FB6080-33F1-487B-B708-EF0114BE6027\"}},\"user\":{},\"at\":1,\"tmax\":2787,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"ashleymadison.com\"],\"source\":{\"fd\":1,\"tid\":\"66a62082-bf7f-46b2-b466-203938355fac\",\"pchain\":\"29e595b1aeb5904d:fd1d59cfe7a8484885922c498a244583\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.15\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"fd1d59cfe7a8484885922c498a244583\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":0}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"3dc586af-bf92-41b7-aa44-89908bf6d10e\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":717,\"h\":360},{\"w\":480,\"h\":320}],\"w\":717,\"h\":360,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":717,\"h\":360,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":717,\"h\":360,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"bidfloor\":0.2100909090909091,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"12acdc3e0c0356ead6747fb3357b2fe0870bd137cfaae196918506dcfccee8166dcf1b4513f01890d381bbc1b12348b5\",\"name\":\"Global City: Build and Harvest\",\"bundle\":\"com.rbx.city.android\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.rbx.city.android\",\"ver\":\"0.4.6509\",\"publisher\":{\"id\":\"2463b2e704af4ef19b1636f1640b2d37\"},\"ext\":{\"appstoreid\":\"com.rbx.city.android\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; RMX2001 Build/RP1A.200720.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/98.0.4758.101 Mobile Safari/537.36\",\"geo\":{\"lat\":1.5608,\"lon\":110.3071,\"type\":2,\"ipservice\":3,\"country\":\"MYS\",\"region\":\"13\",\"city\":\"Kuching\",\"utcoffset\":480},\"dnt\":0,\"lmt\":0,\"ip\":\"183.171.113.26\",\"devicetype\":5,\"make\":\"realme\",\"model\":\"RMX2001\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"RMX2001\",\"h\":1080,\"w\":2153,\"ppi\":160,\"pxratio\":3,\"js\":1,\"language\":\"en\",\"connectiontype\":3,\"ifa\":\"2aeabb01-1e8f-4b1a-94d2-c2390f00c14e\",\"ext\":{\"audiovolume\":0}},\"user\":{},\"at\":1,\"tmax\":786,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB9-7\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"wildberries.ru\",\"kz.wildberries.ru\",\"by.wildberries.ru\",\"games.applife.io\",\"guli-games.com\",\"redbrixwall.com\",\"my.games\",\"wfgo.my.games\",\"swagmasha.org\",\"gohero.es\",\"hawk.my.games\",\"days-after.com\",\"panzerdog.com\",\"merge.my.games\",\"game-garden.com\",\"zc.my.games\",\"lts.my.games\",\"hc.my.games\",\"deuscraft.com\",\"pixonic.com\",\"rr.my.games\",\"merkur24.com\",\"slotpark.com\",\"doubleucasino.com\",\"spinxgames.com\",\"huuugegames.com\",\"murka.com\",\"my.com\",\"evo2.my.games\",\"gaminator.com\",\"huuuge.com\",\"huuugecasino.com\",\"bolegames.com\",\"gaminator-slots.net\",\"ashleymadison.com\"],\"bapp\":[\"1259203065\",\"1166619854\",\"1546438603\",\"1296163413\",\"1024488534\",\"1065803457\",\"844035425\",\"1378876484\",\"1177395683\",\"com.huuuge.casino.texas\",\"com.grandegames.slots.dafu.casino\",\"slots.pcg.casino.games.free.android\",\"com.platogo.gmp\"],\"source\":{\"fd\":1,\"tid\":\"5173fc57-accd-4704-9349-a46362c135ea\",\"pchain\":\"29e595b1aeb5904d:2463b2e704af4ef19b1636f1640b2d37\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"c329d1143bf3b9563361b924b1606c36f232d2ac089a3fbaa4e8224c5c68c56b0a2d3562e0f7ebc5cdc7e601f9883aef\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"2463b2e704af4ef19b1636f1640b2d37\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{}}"
  }
]
~/src/tools/bqdump $ pbpaste | bq query --format=prettyjson --use_legacy_sql=false | bqdump
zsh: permission denied: bqdump
Exception ignored in: <_io.TextIOWrapper name='<stdout>' mode='w' encoding='utf-8'>
BrokenPipeError: [Errno 32] Broken pipe
~/src/tools/bqdump $ pbpaste | bq query --format=prettyjson --use_legacy_sql=false | bqdump
2022/03/31 11:37:28 invalid character 'T' looking for beginning of value
~/src/tools/bqdump $ pbpaste | bq query --format=prettyjson --use_legacy_sql=false
[
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"b30a5b63-2240-4ccc-a4a6-bb76303fc67d\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":360,\"h\":677},{\"w\":320,\"h\":480}],\"w\":360,\"h\":677,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":360,\"h\":677,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":360,\"h\":677,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.9.0\",\"instl\":1,\"tagid\":\"msa_rv_bidding\",\"bidfloor\":1.8239090909090907,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"b9a0eeaaf639734ac37f3acf2a6d4041ea8419c27f90dc365d9f0e6eeabb2b34dafc933db0639769a3279d4f27ad5570\",\"name\":\"My Story: Choose Your Own Path\",\"bundle\":\"org.nanobit.mystory\",\"storeurl\":\"https://play.google.com/store/apps/details?id=org.nanobit.mystory\",\"cat\":[\"IAB9-30\"],\"ver\":\"6.8\",\"publisher\":{\"id\":\"214e146466d642cca931ce8c733eda66\"},\"ext\":{\"appstoreid\":\"org.nanobit.mystory\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 10; EML-L09 Build/HUAWEIEML-L09; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.73 Mobile Safari/537.36\",\"geo\":{\"lat\":53.5652,\"lon\":-2.3765,\"type\":2,\"ipservice\":3,\"country\":\"GBR\",\"region\":\"ENG\",\"city\":\"Bolton\",\"utcoffset\":60},\"dnt\":0,\"lmt\":0,\"ip\":\"82.21.252.234\",\"devicetype\":4,\"make\":\"HUAWEI\",\"model\":\"EML-L09\",\"os\":\"android\",\"osv\":\"10\",\"hwv\":\"EML-L09\",\"h\":2031,\"w\":1080,\"ppi\":480,\"pxratio\":3,\"js\":1,\"language\":\"en_GB\",\"connectiontype\":2,\"ifa\":\"8e89fa21-d861-4515-a124-8071325103de\",\"ext\":{\"audiovolume\":0.47}},\"user\":{\"ext\":{\"consent\":\"1\"}},\"at\":1,\"tmax\":2740,\"bcat\":[\"IAB14-1\",\"IAB11\",\"IAB9-7\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"funplus.net\",\"funplus.com\",\"nanobit.co\",\"ashleymadison.com\"],\"bapp\":[\"com.pixelberrystudios.choices\",\"com.episodeinteractive.android.catalog\",\"com.mars.avgchapters\",\"com.crowdstar.covetfashion\",\"es.parrotgames.restaurantcity\"],\"source\":{\"fd\":1,\"tid\":\"c3139086-9b32-4b4a-a28c-71adc999b8ad\",\"pchain\":\"29e595b1aeb5904d:214e146466d642cca931ce8c733eda66\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"214e146466d642cca931ce8c733eda66\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":1}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"f2bc0007-542e-4d50-a857-7a0e55c10329\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":703,\"h\":360},{\"w\":480,\"h\":320}],\"w\":703,\"h\":360,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":703,\"h\":360,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":703,\"h\":360,\"id\":\"1\",\"ext\":{\"rp\":{\"size_id\":15,\"alt_size_ids\":[101,67,53]}}}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"bidfloor\":0.5854155844155844,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"9d8c383c3f1f0e7095bf79a448d09682eecd3e04e1764daec3e229fc7887d731421faec7f65c5d595953a5ac2254ee01\",\"name\":\"My Cafe â€” Restaurant game\",\"bundle\":\"com.melesta.coffeeshop\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.melesta.coffeeshop\",\"ver\":\"2022.3.1.0\",\"publisher\":{\"id\":\"4808707580f840288b44779cfc32894f\"},\"ext\":{\"appstoreid\":\"com.melesta.coffeeshop\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; SM-A405FN Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.58 Mobile Safari/537.36\",\"geo\":{\"lat\":49.1995,\"lon\":16.6296,\"type\":2,\"ipservice\":3,\"country\":\"CZE\",\"region\":\"64\",\"city\":\"Brno\",\"utcoffset\":120},\"dnt\":0,\"lmt\":0,\"ip\":\"194.212.102.203\",\"devicetype\":5,\"make\":\"samsung\",\"model\":\"SM-A405FN\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"SM-A405FN\",\"h\":810,\"w\":1583,\"ppi\":160,\"pxratio\":2.25,\"js\":1,\"language\":\"cs\",\"connectiontype\":2,\"ifa\":\"3f895c70-cb90-40e1-b1e3-bf4f58d63ccb\",\"ext\":{\"audiovolume\":0}},\"user\":{},\"at\":1,\"tmax\":797,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"glu.com\",\"casualjoygames.com\",\"dragonplus.com\",\"mytona.com\",\"smartfunapps.com\",\"ogzhimyr.com\",\"playrix.com\",\"ashleymadison.com\"],\"bapp\":[\"com.mytona.cookingdiary\",\"com.smartfunapps.crazydiner\",\"com.cookingcity.chef.kitchen.craze.fever.com.casualjoygames.cooking.kitchen\",\"com.dragonplus.cookingfrenzy\",\"com.techvision.restaurant\",\"com.glu.dashtown\",\"com.goodville.goodgame\"],\"source\":{\"fd\":1,\"tid\":\"f44a1965-19c6-479e-9d95-a8e98c13a561\",\"pchain\":\"29e595b1aeb5904d:4808707580f840288b44779cfc32894f\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"c329d1143bf3b9563361b924b1606c36f232d2ac089a3fbaa4e8224c5c68c56b0a2d3562e0f7ebc5cdc7e601f9883aef\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"4808707580f840288b44779cfc32894f\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"8b4059b3-5f0b-4160-a0ea-4280c137a4f4\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":392,\"h\":767},{\"w\":320,\"h\":480}],\"w\":392,\"h\":767,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"interstitial\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":392,\"h\":767,\"placement\":5,\"skip\":1,\"skipafter\":5,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":392,\"h\":767,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"interstitial\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.9.0\",\"instl\":1,\"tagid\":\"MAX_CC_AND_IV_Tapjoy_Bidding\",\"bidfloor\":0.7158634085726363,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"959d02136cf59886ceff194ee5596805f25041b9c45b36b2c7799194b024129c453bcba24c835658ab5876a29c000246\",\"name\":\"ClipClaps - Find your interest\",\"bundle\":\"com.sanhe.clipclaps\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.sanhe.clipclaps\",\"cat\":[\"IAB14\"],\"ver\":\"3.8.7\",\"publisher\":{\"id\":\"de68ccb6b09443d19097082da78b3bf0\"},\"ext\":{\"appstoreid\":\"com.sanhe.clipclaps\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; M2003J15SC Build/RP1A.200720.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.73 Mobile Safari/537.36\",\"geo\":{\"lat\":4.571,\"lon\":-72.9623,\"type\":2,\"ipservice\":3,\"country\":\"COL\",\"region\":\"MET\",\"city\":\"Barranca de Upia\",\"utcoffset\":-300},\"dnt\":0,\"lmt\":0,\"ip\":\"170.246.113.75\",\"devicetype\":4,\"make\":\"Xiaomi\",\"model\":\"M2003J15SC\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"M2003J15SC\",\"h\":2110,\"w\":1080,\"ppi\":440,\"pxratio\":2.75,\"js\":1,\"language\":\"es_US\",\"connectiontype\":2,\"ifa\":\"dba7438f-703f-4ed6-8b08-641208dff887\",\"ext\":{\"audiovolume\":0.27}},\"user\":{},\"at\":1,\"tmax\":2786,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"ashleymadison.com\"],\"source\":{\"fd\":1,\"tid\":\"3b789777-2bee-4269-beb3-d8991167d631\",\"pchain\":\"29e595b1aeb5904d:de68ccb6b09443d19097082da78b3bf0\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"de68ccb6b09443d19097082da78b3bf0\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":0}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"8c2f630e-480e-4a89-84db-2584411e5b23\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":420,\"h\":908},{\"w\":320,\"h\":480}],\"w\":420,\"h\":908,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"interstitial\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":420,\"h\":908,\"placement\":5,\"skip\":1,\"skipafter\":5,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":420,\"h\":908,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"interstitial\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"tagid\":\"IV_MAX\",\"bidfloor\":8.631557027439728,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{\"skadn\":{\"version\":\"2.0\",\"versions\":[\"2.0\"],\"sourceapp\":\"591560124\",\"skadnetids\":[\"9t245vhmpl.skadnetwork\"]}}}],\"app\":{\"id\":\"647384f929f1253da441b5eeca52ca2e28a217f0ffbc0d6966ceea82c1dc9dc0f84f436ad258f6a825b6ab8fc6133139\",\"name\":\"Musi - Simple Music Streaming\",\"bundle\":\"591560124\",\"storeurl\":\"https://apps.apple.com/app/id591560124\",\"cat\":[\"IAB1-6\"],\"ver\":\"26175\",\"publisher\":{\"id\":\"fd1d59cfe7a8484885922c498a244583\"},\"ext\":{\"appstoreid\":\"591560124\"}},\"device\":{\"ua\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 15_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148\",\"geo\":{\"lat\":30.25,\"lon\":-90.91,\"type\":2,\"ipservice\":3,\"country\":\"USA\",\"region\":\"LA\",\"city\":\"Gonzales\",\"utcoffset\":-300},\"dnt\":0,\"lmt\":1,\"ip\":\"68.227.137.0\",\"devicetype\":4,\"make\":\"Apple\",\"model\":\"iPhone14,3\",\"os\":\"ios\",\"osv\":\"15.4\",\"hwv\":\"iPhone14,3\",\"h\":2778,\"w\":1284,\"ppi\":160,\"pxratio\":3.05625,\"js\":1,\"language\":\"en_US\",\"connectiontype\":2,\"ext\":{\"atts\":1,\"audiovolume\":0,\"ifv\":\"D2FB6080-33F1-487B-B708-EF0114BE6027\"}},\"user\":{},\"at\":1,\"tmax\":2787,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"ashleymadison.com\"],\"source\":{\"fd\":1,\"tid\":\"66a62082-bf7f-46b2-b466-203938355fac\",\"pchain\":\"29e595b1aeb5904d:fd1d59cfe7a8484885922c498a244583\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.15\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"fd1d59cfe7a8484885922c498a244583\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":0}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"3dc586af-bf92-41b7-aa44-89908bf6d10e\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":717,\"h\":360},{\"w\":480,\"h\":320}],\"w\":717,\"h\":360,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":717,\"h\":360,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":717,\"h\":360,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"bidfloor\":0.2100909090909091,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"12acdc3e0c0356ead6747fb3357b2fe0870bd137cfaae196918506dcfccee8166dcf1b4513f01890d381bbc1b12348b5\",\"name\":\"Global City: Build and Harvest\",\"bundle\":\"com.rbx.city.android\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.rbx.city.android\",\"ver\":\"0.4.6509\",\"publisher\":{\"id\":\"2463b2e704af4ef19b1636f1640b2d37\"},\"ext\":{\"appstoreid\":\"com.rbx.city.android\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; RMX2001 Build/RP1A.200720.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/98.0.4758.101 Mobile Safari/537.36\",\"geo\":{\"lat\":1.5608,\"lon\":110.3071,\"type\":2,\"ipservice\":3,\"country\":\"MYS\",\"region\":\"13\",\"city\":\"Kuching\",\"utcoffset\":480},\"dnt\":0,\"lmt\":0,\"ip\":\"183.171.113.26\",\"devicetype\":5,\"make\":\"realme\",\"model\":\"RMX2001\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"RMX2001\",\"h\":1080,\"w\":2153,\"ppi\":160,\"pxratio\":3,\"js\":1,\"language\":\"en\",\"connectiontype\":3,\"ifa\":\"2aeabb01-1e8f-4b1a-94d2-c2390f00c14e\",\"ext\":{\"audiovolume\":0}},\"user\":{},\"at\":1,\"tmax\":786,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB9-7\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"wildberries.ru\",\"kz.wildberries.ru\",\"by.wildberries.ru\",\"games.applife.io\",\"guli-games.com\",\"redbrixwall.com\",\"my.games\",\"wfgo.my.games\",\"swagmasha.org\",\"gohero.es\",\"hawk.my.games\",\"days-after.com\",\"panzerdog.com\",\"merge.my.games\",\"game-garden.com\",\"zc.my.games\",\"lts.my.games\",\"hc.my.games\",\"deuscraft.com\",\"pixonic.com\",\"rr.my.games\",\"merkur24.com\",\"slotpark.com\",\"doubleucasino.com\",\"spinxgames.com\",\"huuugegames.com\",\"murka.com\",\"my.com\",\"evo2.my.games\",\"gaminator.com\",\"huuuge.com\",\"huuugecasino.com\",\"bolegames.com\",\"gaminator-slots.net\",\"ashleymadison.com\"],\"bapp\":[\"1259203065\",\"1166619854\",\"1546438603\",\"1296163413\",\"1024488534\",\"1065803457\",\"844035425\",\"1378876484\",\"1177395683\",\"com.huuuge.casino.texas\",\"com.grandegames.slots.dafu.casino\",\"slots.pcg.casino.games.free.android\",\"com.platogo.gmp\"],\"source\":{\"fd\":1,\"tid\":\"5173fc57-accd-4704-9349-a46362c135ea\",\"pchain\":\"29e595b1aeb5904d:2463b2e704af4ef19b1636f1640b2d37\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"c329d1143bf3b9563361b924b1606c36f232d2ac089a3fbaa4e8224c5c68c56b0a2d3562e0f7ebc5cdc7e601f9883aef\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"2463b2e704af4ef19b1636f1640b2d37\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{}}"
  }
]
~/src/tools/bqdump $ pbpaste | bq query --format=prettyjson --use_legacy_sql=false | bqdump
2022/03/31 11:38:02 invalid character 'T' looking for beginning of value
~/src/tools/bqdump $ pbpaste | bq query --format=prettyjson --use_legacy_sql=false
[
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"b30a5b63-2240-4ccc-a4a6-bb76303fc67d\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":360,\"h\":677},{\"w\":320,\"h\":480}],\"w\":360,\"h\":677,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":360,\"h\":677,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":360,\"h\":677,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.9.0\",\"instl\":1,\"tagid\":\"msa_rv_bidding\",\"bidfloor\":1.8239090909090907,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"b9a0eeaaf639734ac37f3acf2a6d4041ea8419c27f90dc365d9f0e6eeabb2b34dafc933db0639769a3279d4f27ad5570\",\"name\":\"My Story: Choose Your Own Path\",\"bundle\":\"org.nanobit.mystory\",\"storeurl\":\"https://play.google.com/store/apps/details?id=org.nanobit.mystory\",\"cat\":[\"IAB9-30\"],\"ver\":\"6.8\",\"publisher\":{\"id\":\"214e146466d642cca931ce8c733eda66\"},\"ext\":{\"appstoreid\":\"org.nanobit.mystory\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 10; EML-L09 Build/HUAWEIEML-L09; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.73 Mobile Safari/537.36\",\"geo\":{\"lat\":53.5652,\"lon\":-2.3765,\"type\":2,\"ipservice\":3,\"country\":\"GBR\",\"region\":\"ENG\",\"city\":\"Bolton\",\"utcoffset\":60},\"dnt\":0,\"lmt\":0,\"ip\":\"82.21.252.234\",\"devicetype\":4,\"make\":\"HUAWEI\",\"model\":\"EML-L09\",\"os\":\"android\",\"osv\":\"10\",\"hwv\":\"EML-L09\",\"h\":2031,\"w\":1080,\"ppi\":480,\"pxratio\":3,\"js\":1,\"language\":\"en_GB\",\"connectiontype\":2,\"ifa\":\"8e89fa21-d861-4515-a124-8071325103de\",\"ext\":{\"audiovolume\":0.47}},\"user\":{\"ext\":{\"consent\":\"1\"}},\"at\":1,\"tmax\":2740,\"bcat\":[\"IAB14-1\",\"IAB11\",\"IAB9-7\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"funplus.net\",\"funplus.com\",\"nanobit.co\",\"ashleymadison.com\"],\"bapp\":[\"com.pixelberrystudios.choices\",\"com.episodeinteractive.android.catalog\",\"com.mars.avgchapters\",\"com.crowdstar.covetfashion\",\"es.parrotgames.restaurantcity\"],\"source\":{\"fd\":1,\"tid\":\"c3139086-9b32-4b4a-a28c-71adc999b8ad\",\"pchain\":\"29e595b1aeb5904d:214e146466d642cca931ce8c733eda66\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"214e146466d642cca931ce8c733eda66\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":1}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"f2bc0007-542e-4d50-a857-7a0e55c10329\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":703,\"h\":360},{\"w\":480,\"h\":320}],\"w\":703,\"h\":360,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":703,\"h\":360,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":703,\"h\":360,\"id\":\"1\",\"ext\":{\"rp\":{\"size_id\":15,\"alt_size_ids\":[101,67,53]}}}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"bidfloor\":0.5854155844155844,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"9d8c383c3f1f0e7095bf79a448d09682eecd3e04e1764daec3e229fc7887d731421faec7f65c5d595953a5ac2254ee01\",\"name\":\"My Cafe â€” Restaurant game\",\"bundle\":\"com.melesta.coffeeshop\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.melesta.coffeeshop\",\"ver\":\"2022.3.1.0\",\"publisher\":{\"id\":\"4808707580f840288b44779cfc32894f\"},\"ext\":{\"appstoreid\":\"com.melesta.coffeeshop\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; SM-A405FN Build/RP1A.200720.012; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.58 Mobile Safari/537.36\",\"geo\":{\"lat\":49.1995,\"lon\":16.6296,\"type\":2,\"ipservice\":3,\"country\":\"CZE\",\"region\":\"64\",\"city\":\"Brno\",\"utcoffset\":120},\"dnt\":0,\"lmt\":0,\"ip\":\"194.212.102.203\",\"devicetype\":5,\"make\":\"samsung\",\"model\":\"SM-A405FN\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"SM-A405FN\",\"h\":810,\"w\":1583,\"ppi\":160,\"pxratio\":2.25,\"js\":1,\"language\":\"cs\",\"connectiontype\":2,\"ifa\":\"3f895c70-cb90-40e1-b1e3-bf4f58d63ccb\",\"ext\":{\"audiovolume\":0}},\"user\":{},\"at\":1,\"tmax\":797,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"glu.com\",\"casualjoygames.com\",\"dragonplus.com\",\"mytona.com\",\"smartfunapps.com\",\"ogzhimyr.com\",\"playrix.com\",\"ashleymadison.com\"],\"bapp\":[\"com.mytona.cookingdiary\",\"com.smartfunapps.crazydiner\",\"com.cookingcity.chef.kitchen.craze.fever.com.casualjoygames.cooking.kitchen\",\"com.dragonplus.cookingfrenzy\",\"com.techvision.restaurant\",\"com.glu.dashtown\",\"com.goodville.goodgame\"],\"source\":{\"fd\":1,\"tid\":\"f44a1965-19c6-479e-9d95-a8e98c13a561\",\"pchain\":\"29e595b1aeb5904d:4808707580f840288b44779cfc32894f\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"c329d1143bf3b9563361b924b1606c36f232d2ac089a3fbaa4e8224c5c68c56b0a2d3562e0f7ebc5cdc7e601f9883aef\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"4808707580f840288b44779cfc32894f\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"8b4059b3-5f0b-4160-a0ea-4280c137a4f4\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":392,\"h\":767},{\"w\":320,\"h\":480}],\"w\":392,\"h\":767,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"interstitial\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":392,\"h\":767,\"placement\":5,\"skip\":1,\"skipafter\":5,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":392,\"h\":767,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"interstitial\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.9.0\",\"instl\":1,\"tagid\":\"MAX_CC_AND_IV_Tapjoy_Bidding\",\"bidfloor\":0.7158634085726363,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"959d02136cf59886ceff194ee5596805f25041b9c45b36b2c7799194b024129c453bcba24c835658ab5876a29c000246\",\"name\":\"ClipClaps - Find your interest\",\"bundle\":\"com.sanhe.clipclaps\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.sanhe.clipclaps\",\"cat\":[\"IAB14\"],\"ver\":\"3.8.7\",\"publisher\":{\"id\":\"de68ccb6b09443d19097082da78b3bf0\"},\"ext\":{\"appstoreid\":\"com.sanhe.clipclaps\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; M2003J15SC Build/RP1A.200720.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/99.0.4844.73 Mobile Safari/537.36\",\"geo\":{\"lat\":4.571,\"lon\":-72.9623,\"type\":2,\"ipservice\":3,\"country\":\"COL\",\"region\":\"MET\",\"city\":\"Barranca de Upia\",\"utcoffset\":-300},\"dnt\":0,\"lmt\":0,\"ip\":\"170.246.113.75\",\"devicetype\":4,\"make\":\"Xiaomi\",\"model\":\"M2003J15SC\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"M2003J15SC\",\"h\":2110,\"w\":1080,\"ppi\":440,\"pxratio\":2.75,\"js\":1,\"language\":\"es_US\",\"connectiontype\":2,\"ifa\":\"dba7438f-703f-4ed6-8b08-641208dff887\",\"ext\":{\"audiovolume\":0.27}},\"user\":{},\"at\":1,\"tmax\":2786,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"ashleymadison.com\"],\"source\":{\"fd\":1,\"tid\":\"3b789777-2bee-4269-beb3-d8991167d631\",\"pchain\":\"29e595b1aeb5904d:de68ccb6b09443d19097082da78b3bf0\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"de68ccb6b09443d19097082da78b3bf0\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":0}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"8c2f630e-480e-4a89-84db-2584411e5b23\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":420,\"h\":908},{\"w\":320,\"h\":480}],\"w\":420,\"h\":908,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"interstitial\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":420,\"h\":908,\"placement\":5,\"skip\":1,\"skipafter\":5,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":420,\"h\":908,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"interstitial\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"tagid\":\"IV_MAX\",\"bidfloor\":8.631557027439728,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{\"skadn\":{\"version\":\"2.0\",\"versions\":[\"2.0\"],\"sourceapp\":\"591560124\",\"skadnetids\":[\"9t245vhmpl.skadnetwork\"]}}}],\"app\":{\"id\":\"647384f929f1253da441b5eeca52ca2e28a217f0ffbc0d6966ceea82c1dc9dc0f84f436ad258f6a825b6ab8fc6133139\",\"name\":\"Musi - Simple Music Streaming\",\"bundle\":\"591560124\",\"storeurl\":\"https://apps.apple.com/app/id591560124\",\"cat\":[\"IAB1-6\"],\"ver\":\"26175\",\"publisher\":{\"id\":\"fd1d59cfe7a8484885922c498a244583\"},\"ext\":{\"appstoreid\":\"591560124\"}},\"device\":{\"ua\":\"Mozilla/5.0 (iPhone; CPU iPhone OS 15_4 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148\",\"geo\":{\"lat\":30.25,\"lon\":-90.91,\"type\":2,\"ipservice\":3,\"country\":\"USA\",\"region\":\"LA\",\"city\":\"Gonzales\",\"utcoffset\":-300},\"dnt\":0,\"lmt\":1,\"ip\":\"68.227.137.0\",\"devicetype\":4,\"make\":\"Apple\",\"model\":\"iPhone14,3\",\"os\":\"ios\",\"osv\":\"15.4\",\"hwv\":\"iPhone14,3\",\"h\":2778,\"w\":1284,\"ppi\":160,\"pxratio\":3.05625,\"js\":1,\"language\":\"en_US\",\"connectiontype\":2,\"ext\":{\"atts\":1,\"audiovolume\":0,\"ifv\":\"D2FB6080-33F1-487B-B708-EF0114BE6027\"}},\"user\":{},\"at\":1,\"tmax\":2787,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB11-4\",\"IAB26-4\",\"IAB26-2\",\"IAB8-18\",\"IAB25-2\",\"IAB25-6\",\"IAB8-5\",\"IAB25-5\",\"IAB25-4\",\"IAB25-3\",\"IAB25-7\",\"IAB25-1\",\"IAB26-3\",\"IAB26-1\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"ashleymadison.com\"],\"source\":{\"fd\":1,\"tid\":\"66a62082-bf7f-46b2-b466-203938355fac\",\"pchain\":\"29e595b1aeb5904d:fd1d59cfe7a8484885922c498a244583\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"4f91978e480670a5c87a8c58fe3f97f9727c29e7b833c1dc151ebc575a0acd6540632750beb80e37aa725ab8637ebc1a\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.15\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"fd1d59cfe7a8484885922c498a244583\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{\"ext\":{\"gdpr\":0}}}"
  },
  {
    "exchange": "TAPJOY",
    "jv": "{\"id\":\"3dc586af-bf92-41b7-aa44-89908bf6d10e\",\"imp\":[{\"id\":\"1\",\"banner\":{\"format\":[{\"w\":717,\"h\":360},{\"w\":480,\"h\":320}],\"w\":717,\"h\":360,\"api\":[7,3,5],\"id\":\"1\",\"ext\":{\"placementtype\":\"rewarded\",\"allowscustomclosebutton\":false}},\"video\":{\"mimes\":[\"video/mp4\",\"video/webm\"],\"maxduration\":35,\"protocols\":[2,3,5,6],\"w\":717,\"h\":360,\"placement\":5,\"skip\":0,\"maxbitrate\":2000,\"playbackmethod\":[1,3],\"companionad\":[{\"w\":717,\"h\":360,\"id\":\"1\"}],\"api\":[7],\"companiontype\":[1],\"ext\":{\"placementtype\":\"rewarded\"}},\"displaymanager\":\"Tapjoy SDK\",\"displaymanagerver\":\"12.8.1\",\"instl\":1,\"bidfloor\":0.2100909090909091,\"bidfloorcur\":\"USD\",\"secure\":1,\"ext\":{}}],\"app\":{\"id\":\"12acdc3e0c0356ead6747fb3357b2fe0870bd137cfaae196918506dcfccee8166dcf1b4513f01890d381bbc1b12348b5\",\"name\":\"Global City: Build and Harvest\",\"bundle\":\"com.rbx.city.android\",\"storeurl\":\"https://play.google.com/store/apps/details?id=com.rbx.city.android\",\"ver\":\"0.4.6509\",\"publisher\":{\"id\":\"2463b2e704af4ef19b1636f1640b2d37\"},\"ext\":{\"appstoreid\":\"com.rbx.city.android\"}},\"device\":{\"ua\":\"Mozilla/5.0 (Linux; Android 11; RMX2001 Build/RP1A.200720.011; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/98.0.4758.101 Mobile Safari/537.36\",\"geo\":{\"lat\":1.5608,\"lon\":110.3071,\"type\":2,\"ipservice\":3,\"country\":\"MYS\",\"region\":\"13\",\"city\":\"Kuching\",\"utcoffset\":480},\"dnt\":0,\"lmt\":0,\"ip\":\"183.171.113.26\",\"devicetype\":5,\"make\":\"realme\",\"model\":\"RMX2001\",\"os\":\"android\",\"osv\":\"11\",\"hwv\":\"RMX2001\",\"h\":1080,\"w\":2153,\"ppi\":160,\"pxratio\":3,\"js\":1,\"language\":\"en\",\"connectiontype\":3,\"ifa\":\"2aeabb01-1e8f-4b1a-94d2-c2390f00c14e\",\"ext\":{\"audiovolume\":0}},\"user\":{},\"at\":1,\"tmax\":786,\"bcat\":[\"IAB9-7\",\"IAB14-1\",\"IAB11\",\"IAB9-7\",\"IAB11\",\"IAB9-9\",\"IAB7-39\",\"IAB23\",\"IAB25\",\"IAB26\"],\"badv\":[\"wildberries.ru\",\"kz.wildberries.ru\",\"by.wildberries.ru\",\"games.applife.io\",\"guli-games.com\",\"redbrixwall.com\",\"my.games\",\"wfgo.my.games\",\"swagmasha.org\",\"gohero.es\",\"hawk.my.games\",\"days-after.com\",\"panzerdog.com\",\"merge.my.games\",\"game-garden.com\",\"zc.my.games\",\"lts.my.games\",\"hc.my.games\",\"deuscraft.com\",\"pixonic.com\",\"rr.my.games\",\"merkur24.com\",\"slotpark.com\",\"doubleucasino.com\",\"spinxgames.com\",\"huuugegames.com\",\"murka.com\",\"my.com\",\"evo2.my.games\",\"gaminator.com\",\"huuuge.com\",\"huuugecasino.com\",\"bolegames.com\",\"gaminator-slots.net\",\"ashleymadison.com\"],\"bapp\":[\"1259203065\",\"1166619854\",\"1546438603\",\"1296163413\",\"1024488534\",\"1065803457\",\"844035425\",\"1378876484\",\"1177395683\",\"com.huuuge.casino.texas\",\"com.grandegames.slots.dafu.casino\",\"slots.pcg.casino.games.free.android\",\"com.platogo.gmp\"],\"source\":{\"fd\":1,\"tid\":\"5173fc57-accd-4704-9349-a46362c135ea\",\"pchain\":\"29e595b1aeb5904d:2463b2e704af4ef19b1636f1640b2d37\",\"ext\":{\"header_bidding\":1,\"mediator_id\":\"c329d1143bf3b9563361b924b1606c36f232d2ac089a3fbaa4e8224c5c68c56b0a2d3562e0f7ebc5cdc7e601f9883aef\",\"omidpn\":\"Tapjoy\",\"omidpv\":\"1.3.16\",\"schain\":{\"complete\":1,\"nodes\":[{\"asi\":\"tapjoy.com\",\"sid\":\"2463b2e704af4ef19b1636f1640b2d37\",\"hp\":1}],\"ver\":\"1.0\"}}},\"regs\":{}}"
  }
]
`

func TestComplicatedInput(t *testing.T) {
	stringReader := strings.NewReader(input1)
	do(stringReader)
}
